Operating system: Windows 10/11, Linux (Python 3.8+ and PyTorch environment are required).

File format requirements: this software adopts built-in generative learning mode, and no external input files are needed in the training stage. The program will automatically generate training samples containing three-dimensional density model and corresponding gravity anomaly data. In the stage of inferring the trained model, the input file only needs one gravity data file (.npy format or Tensor format matrix), which contains two-dimensional gridded gravity anomaly (Gz) or gradient data (GZ).

Code description: "transunet.py" is a complete program. Just run this file to start. The code includes the functions of parameter setting, model training monitoring and result data visualization. The code is mainly divided into two parts.
(1) The first part is "configuration and parameter setting" (corresponding to the V4Config class in the code). Here, you can select the grid parameters of gravity inversion, and set the grid dimension (default 16, 32, 32) and grid spacing (dx, dz) of the inversion area. You can also set deep learning calculation parameters, including learning rate, Batch Size and maximum number of training rounds (Epochs). In this section, we will also input physical constraint parameters, such as depth weighting index, physical consistency loss weight, edge enhancement coefficient, and geological model types (prism, sphere, fault, etc.) configured to automatically generate training data to train the model.
(2) The second part is the "result output part", which runs automatically during and after the training. It includes the three-dimensional density data volume obtained by inversion (saved as the best model weight), the Learning Curves of loss function and the inversion accuracy index (Deep IoU) during training, as well as the density slice image, three-dimensional voxel rendering map and gravity anomaly fitting contrast map obtained by using the verification set in the inversion process to see how the model training is going.
